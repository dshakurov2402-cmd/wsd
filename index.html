<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Abol Messenger</title>
    <style>
        * { box-sizing: border-box; margin: 0; padding: 0; font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; }
        body { background-color: #e6ebee; display: flex; justify-content: center; align-items: center; height: 100vh; }

        .app-container { width: 1000px; height: 90vh; background: white; display: flex; box-shadow: 0 10px 25px rgba(0,0,0,0.1); border-radius: 8px; overflow: hidden; }

        /* Боковая панель */
        .sidebar { width: 30%; border-right: 1px solid #ddd; display: flex; flex-direction: column; background: #fff; }
        .search-container { padding: 20px; background: #fff; }
        .search-container input { width: 100%; padding: 10px; border: 1px solid #dfe1e5; border-radius: 20px; outline: none; background: #f1f3f4; }
        
        .contact-list { flex: 1; overflow-y: auto; }
        .contact { padding: 15px 20px; cursor: pointer; border-bottom: 1px solid #f5f5f5; transition: 0.3s; display: flex; align-items: center; }
        .contact:hover { background: #f0f7ff; }
        .contact .avatar { width: 45px; height: 45px; background: #0088cc; border-radius: 50%; margin-right: 15px; color: white; display: flex; align-items: center; justify-content: center; font-weight: bold; }

        /* Окно чата */
        .chat-window { width: 70%; display: flex; flex-direction: column; background: #f5f5f5; position: relative; }
        .chat-header { padding: 15px 25px; background: white; border-bottom: 1px solid #ddd; font-weight: bold; font-size: 1.1em; }
        
        #messages { flex: 1; padding: 20px; overflow-y: auto; display: flex; flex-direction: column; gap: 10px; background-image: url('https://www.toptal.com/designers/subtlepatterns/uploads/double-bubble-outline.png'); }
        .msg { max-width: 60%; padding: 10px 15px; border-radius: 15px; font-size: 0.95em; line-height: 1.4; position: relative; }
        .msg.sent { align-self: flex-end; background: #effdde; border-bottom-right-radius: 2px; box-shadow: 0 1px 2px rgba(0,0,0,0.1); }
        .msg.received { align-self: flex-start; background: white; border-bottom-left-radius: 2px; box-shadow: 0 1px 2px rgba(0,0,0,0.1); }

        .input-area { padding: 15px; background: white; display: flex; gap: 10px; }
        .input-area input { flex: 1; padding: 12px; border: 1px solid #ddd; border-radius: 5px; outline: none; }
        .input-area button { padding: 0 20px; background: #0088cc; color: white; border: none; border-radius: 5px; cursor: pointer; font-weight: bold; }
        .input-area button:hover { background: #0077b3; }
        
        .empty-chat { display: flex; flex-direction: column; align-items: center; justify-content: center; height: 100%; color: #888; }
    </style>
</head>
<body>

<div class="app-container">
    <div class="sidebar">
        <div class="search-container">
            <input type="text" id="userSearch" placeholder="Поиск по username..." onkeyup="searchUser()">
        </div>
        <div class="contact-list" id="contactList">
            </div>
    </div>

    <div class="chat-window" id="chatWindow">
        <div class="empty-chat" id="noChat">
            <p>Выберите, кому написать, через поиск</p>
        </div>
        <div id="chatActive" style="display: none; height: 100%; flex-direction: column;">
            <div class="chat-header" id="currentChatUser">Username</div>
            <div id="messages"></div>
            <div class="input-area">
                <input type="text" id="msgInput" placeholder="Напишите сообщение...">
                <button onclick="sendMessage()">ОТПРАВИТЬ</button>
            </div>
        </div>
    </div>
</div>

<script>
    // Имитация базы данных пользователей
    const users = [
        { username: "@tester", name: "Тестировщик" },
        { username: "@admin", name: "Администратор" },
        { username: "@dshakurov", name: "Дамир" },
        { username: "@friend", name: "Друг" }
    ];

    let activeUser = null;

    function searchUser() {
        const input = document.getElementById('userSearch').value.toLowerCase();
        const list = document.getElementById('contactList');
        list.innerHTML = "";

        if (input.length > 0) {
            const filtered = users.filter(u => u.username.toLowerCase().includes(input));
            filtered.forEach(user => {
                const div = document.createElement('div');
                div.className = 'contact';
                div.innerHTML = `<div class="avatar">${user.username[1].toUpperCase()}</div> <div><strong>${user.name}</strong><br><small>${user.username}</small></div>`;
                div.onclick = () => openChat(user);
                list.appendChild(div);
            });
        }
    }

    function openChat(user) {
        activeUser = user;
        document.getElementById('noChat').style.display = 'none';
        document.getElementById('chatActive').style.display = 'flex';
        document.getElementById('currentChatUser').innerText = user.name + " (" + user.username + ")";
        document.getElementById('messages').innerHTML = ""; // Очистка старых сообщений
        
        // Приветственное сообщение от "бота"
        addMessage(`Привет! Ты нашел меня по юзернейму ${user.username}.`, 'received');
    }

    function sendMessage() {
        const input = document.getElementById('msgInput');
        const text = input.value.trim();
        if (text !== "" && activeUser) {
            addMessage(text, 'sent');
            input.value = "";
            
            // Маленькая авто-ответка для имитации переписки
            setTimeout(() => {
                addMessage("Сообщение доставлено на сервер (имитация)", "received");
            }, 1000);
        }
    }

    function addMessage(text, type) {
        const msgDiv = document.createElement('div');
        msgDiv.className = `msg ${type}`;
        msgDiv.innerText = text;
        const container = document.getElementById('messages');
        container.appendChild(msgDiv);
        container.scrollTop = container.scrollHeight;
    }

    // Отправка по нажатию Enter
    document.getElementById('msgInput').addEventListener("keypress", function(event) {
        if (event.key === "Enter") {
            sendMessage();
        }
    });
</script>

</body>
</html>
